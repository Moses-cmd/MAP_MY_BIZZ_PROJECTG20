<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Forgot Password</title>
  <link rel="stylesheet" href="../CSS/style.css">
</head>
<body>

  <!-- Navbar -->
  <nav class="navbar">
    <div class="logo-container">
      <img src="../Assets/MMB.png" alt="Map My Biz Logo" />
    </div>
  </nav>

  <!-- Forgot Password Form -->
  <div class="container form-container">
    <h2>Forgot Your Password?</h2>
    <p>Enter your registered email and we'll send you a link to reset it.</p>

    <form id="forgotPasswordForm">
      <div class="form-group">
        <label for="email">Email Address</label>
        <input type="email" id="email" name="email" required placeholder="you@example.com" />
      </div>
      <button type="submit" class="btn-primary">Send Reset Link</button>
    </form>

    <p class="back-to-login"><a href="../index.html">Back to Login</a></p>
  </div>

  <script type="module">
    import supabase from "../supabaseClient.js";
  
    document.getElementById("forgotPasswordForm").addEventListener("submit", async (e) => {
      e.preventDefault();
  
      const email = document.getElementById("email").value.trim();
  
      if (!email) {
        alert("Please enter your email.");
        return;
      }
  
      const redirectTo = "http://localhost:5500/PAGES/reset-password.html";
  
      const { error } = await supabase.auth.resetPasswordForEmail(email, {
        redirectTo,
      });
  
      if (error) {
        console.error("Reset error:", error.message);
        alert("Error: " + error.message);
      } else {
        alert("✅ Check your email for the reset link!");
        setTimeout(() => {
          window.location.href = "../index.html";
        }, 2000);
      }
      // ✅ No password update here — handled in reset-password.html
    });
  </script>

  <!-- Load main app logic (optional) -->
  <script type="module" src="../JS/script.js"></script>
</body>
</html>